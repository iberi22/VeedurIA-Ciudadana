
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudio de Viabilidad: Veedur√≠a Ciudadana AI & Open Source</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: 'Civil Clarity' - Warm neutrals (Cream/Beige) for background, Dark Slate for text, with functional highlighting in Terra Cotta and Steel Blue. Minimalist and trustworthy. -->

    <!-- Application Structure Plan:
         1. **Executive Dashboard**: High-level summary of the investigation results (Viability, Risk, Impact).
         2. **Architecture Explorer**: An interactive block diagram (HTML/CSS) visualizing the proposed pipeline (Colombian Portals -> GitHub Actions/Rust -> AI -> Frontend). Clicking nodes explains the technical feasibility.
         3. **Data Source Atlas**: A filterable grid of Colombian public data sources (SECOP, Datos.gov.co) showing API compatibility and relevance.
         4. **Tech Stack Analysis**: Comparative charts (Rust vs. Python performance, GitHub Actions vs. AWS costs) to justify the specific technical choices.
         5. **Prototype Simulator**: A step-by-step interactive simulation of how the "Rust Binary" and "AI Agent" would process a specific corruption risk case.

         WHY: This structure moves from the strategic "Yes/No" (Dashboard) to the technical "How" (Architecture/Stack) and finally the practical "What it looks like" (Simulator), mirroring a typical decision-making process for technical projects.
    -->

    <!-- Visualization & Content Choices:
         - Viability Gauge (Doughnut Chart): To give an immediate visual answer to "Is it viable?".
         - Architecture Flow (CSS Flex/Grid Flowchart): To visualize the 'Serverless on GitHub' concept without SVGs.
         - Cost/Performance Analysis (Bar/Radar Charts): To quantitatively justify using Rust and GitHub Actions over traditional cloud servers.
         - Data Source Cards (Interactive Grid): To catalog the specific Colombian endpoints available.
         - Process Simulator (DOM Manipulation): To demonstrate the 'Rust ETL' logic without backend code.

         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->

    <style>
        body {
            background-color: #fdfbf7; /* Warm neutral background */
            color: #1f2937; /* Dark Slate text */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Custom Scrollbar for clean look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        .nav-item.active {
            border-bottom: 3px solid #e07a5f; /* Terra Cotta */
            color: #3d405b;
            font-weight: 700;
        }

        .node-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .node-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: #e07a5f;
        }
        .node-active {
            border-color: #e07a5f !important;
            background-color: #fff1ed !important;
        }

        .animate-pulse-fast {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-2">
                    <div class="h-8 w-8 bg-slate-800 rounded-md flex items-center justify-center text-white font-bold">V</div>
                    <span class="font-bold text-xl tracking-tight text-slate-800">Veedur√≠a<span class="text-orange-600">AI</span>.co</span>
                </div>
                <nav class="hidden md:flex space-x-8">
                    <button onclick="switchTab('dashboard')" class="nav-item active px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors" id="nav-dashboard">Panorama</button>
                    <button onclick="switchTab('architecture')" class="nav-item px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors" id="nav-architecture">Arquitectura T√©cnica</button>
                    <button onclick="switchTab('data')" class="nav-item px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors" id="nav-data">Fuentes (Colombia)</button>
                    <button onclick="switchTab('simulator')" class="nav-item px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors" id="nav-simulator">Simulador IA</button>
                </nav>
                <div class="flex items-center">
                    <span class="px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800 border border-green-200">Viabilidad: ALTA</span>
                </div>
            </div>
        </div>
        <!-- Mobile Nav -->
        <div class="md:hidden border-t border-gray-200 bg-gray-50 flex justify-around p-2">
            <button onclick="switchTab('dashboard')" class="text-xs font-medium p-2 text-gray-600">Panorama</button>
            <button onclick="switchTab('architecture')" class="text-xs font-medium p-2 text-gray-600">Arquitectura</button>
            <button onclick="switchTab('simulator')" class="text-xs font-medium p-2 text-gray-600">Simulador</button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

        <!-- VIEW: DASHBOARD (Executive Summary) -->
        <section id="view-dashboard" class="space-y-8 animate-fade-in">
            <div class="bg-white rounded-xl shadow-sm border border-stone-100 p-6 md:p-8">
                <div class="max-w-3xl">
                    <h1 class="text-3xl font-bold text-slate-800 mb-4">Investigaci√≥n de Viabilidad T√©cnica</h1>
                    <p class="text-lg text-gray-600 leading-relaxed mb-6">
                        An√°lisis para la creaci√≥n de un <strong>Sistema de Veedur√≠a Ciudadana Distribuido</strong> utilizando infraestructura Open Source (GitHub), procesamiento de alto rendimiento (Rust) e Inteligencia Artificial.
                    </p>
                    <p class="text-gray-600 mb-4">
                        <strong>Conclusi√≥n:</strong> El proyecto es <span class="text-green-600 font-bold">T√©cnicamente Viable</span> y econ√≥micamente eficiente. El uso de GitHub Actions como motor de c√≥mputo ETL ("Git Scraping") combinado con la eficiencia de Rust permite procesar los grandes vol√∫menes de datos de contrataci√≥n estatal sin incurrir en costos de servidores en la nube tradicionales.
                    </p>
                </div>
            </div>

            <!-- Metrics Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Card 1 -->
                <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-emerald-500">
                    <h3 class="text-sm font-medium text-gray-500 uppercase">Costo Infraestructura</h3>
                    <p class="mt-2 text-3xl font-bold text-gray-900">$0 / mes</p>
                    <p class="text-xs text-gray-500 mt-1">Plan Free GitHub + Open Data</p>
                </div>
                <!-- Card 2 -->
                <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                    <h3 class="text-sm font-medium text-gray-500 uppercase">Fuentes Disponibles</h3>
                    <p class="mt-2 text-3xl font-bold text-gray-900">12+</p>
                    <p class="text-xs text-gray-500 mt-1">SECOP I/II, Sisfuturo, etc.</p>
                </div>
                <!-- Card 3 -->
                <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-orange-500">
                    <h3 class="text-sm font-medium text-gray-500 uppercase">Velocidad Rust</h3>
                    <p class="mt-2 text-3xl font-bold text-gray-900">25x</p>
                    <p class="text-xs text-gray-500 mt-1">Vs. Python en GitHub Runners</p>
                </div>
                <!-- Card 4 -->
                <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-purple-500">
                    <h3 class="text-sm font-medium text-gray-500 uppercase">Modelo IA</h3>
                    <p class="mt-2 text-3xl font-bold text-gray-900">H√≠brido</p>
                    <p class="text-xs text-gray-500 mt-1">Local (Bert) + API (LLM)</p>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Chart 1: Resource Efficiency -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                    <h3 class="text-lg font-semibold text-slate-800 mb-2">Comparativa de Eficiencia en "CI/CD Runners"</h3>
                    <p class="text-sm text-gray-500 mb-6">Por qu√© usar Rust es cr√≠tico para mantenerse dentro de los l√≠mites gratuitos de GitHub Actions (2000 min/mes).</p>
                    <div class="chart-container">
                        <canvas id="efficiencyChart"></canvas>
                    </div>
                </div>

                <!-- Chart 2: Data Coverage -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                    <h3 class="text-lg font-semibold text-slate-800 mb-2">Cobertura de Datos P√∫blicos Colombia</h3>
                    <p class="text-sm text-gray-500 mb-6">Disponibilidad de APIs abiertas y calidad de datos estructurados para ingesti√≥n.</p>
                    <div class="chart-container">
                        <canvas id="coverageChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- VIEW: ARCHITECTURE (Visual Flow) -->
        <section id="view-architecture" class="hidden space-y-8 animate-fade-in">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <h2 class="text-2xl font-bold text-slate-800 mb-4">Arquitectura "Git Scraping" Propuesta</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">
                    Este modelo elimina la necesidad de una base de datos activa (como PostgreSQL) para la capa de lectura. El repositorio de GitHub act√∫a como "Data Lake". Los <strong>Workflows</strong> programados ejecutan binarios compilados de <strong>Rust</strong> que descargan, limpian y analizan datos, generando reportes est√°ticos (JSON/HTML) que la IA consume y mejora.
                </p>

                <!-- Interactive Flowchart -->
                <div class="flex flex-col md:flex-row items-stretch justify-between gap-4 relative">
                    <!-- Connector Line (Desktop) -->
                    <div class="hidden md:block absolute top-1/2 left-0 w-full h-1 bg-gray-200 -z-0 transform -translate-y-1/2"></div>

                    <!-- Node 1 -->
                    <div onclick="showNodeDetails('source')" class="node-card relative z-10 flex-1 bg-white border-2 border-blue-100 p-4 rounded-lg text-center group hover:bg-blue-50">
                        <div class="w-12 h-12 mx-auto bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mb-3 text-2xl group-hover:bg-blue-200">üèõÔ∏è</div>
                        <h4 class="font-bold text-slate-700">1. Fuentes P√∫blicas</h4>
                        <p class="text-xs text-gray-500 mt-1">Datos.gov.co API<br>Socrata / CKAN</p>
                    </div>

                    <!-- Node 2 -->
                    <div onclick="showNodeDetails('etl')" class="node-card relative z-10 flex-1 bg-white border-2 border-orange-100 p-4 rounded-lg text-center group hover:bg-orange-50">
                        <div class="w-12 h-12 mx-auto bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mb-3 text-2xl group-hover:bg-orange-200">‚öôÔ∏è</div>
                        <h4 class="font-bold text-slate-700">2. GitHub Actions + Rust</h4>
                        <p class="text-xs text-gray-500 mt-1">Cron Job diario<br>Binario Rust Optimizado</p>
                    </div>

                    <!-- Node 3 -->
                    <div onclick="showNodeDetails('storage')" class="node-card relative z-10 flex-1 bg-white border-2 border-gray-200 p-4 rounded-lg text-center group hover:bg-gray-50">
                        <div class="w-12 h-12 mx-auto bg-gray-100 text-gray-600 rounded-full flex items-center justify-center mb-3 text-2xl group-hover:bg-gray-200">üì¶</div>
                        <h4 class="font-bold text-slate-700">3. Git "Data Lake"</h4>
                        <p class="text-xs text-gray-500 mt-1">Archivos Flat (JSON/Parquet)<br>Control de Versiones</p>
                    </div>

                    <!-- Node 4 -->
                    <div onclick="showNodeDetails('ai')" class="node-card relative z-10 flex-1 bg-white border-2 border-purple-100 p-4 rounded-lg text-center group hover:bg-purple-50">
                        <div class="w-12 h-12 mx-auto bg-purple-100 text-purple-600 rounded-full flex items-center justify-center mb-3 text-2xl group-hover:bg-purple-200">üß†</div>
                        <h4 class="font-bold text-slate-700">4. An√°lisis IA</h4>
                        <p class="text-xs text-gray-500 mt-1">Detecci√≥n de Patrones<br>Resumen LLM</p>
                    </div>

                    <!-- Node 5 -->
                    <div onclick="showNodeDetails('frontend')" class="node-card relative z-10 flex-1 bg-white border-2 border-green-100 p-4 rounded-lg text-center group hover:bg-green-50">
                        <div class="w-12 h-12 mx-auto bg-green-100 text-green-600 rounded-full flex items-center justify-center mb-3 text-2xl group-hover:bg-green-200">üíª</div>
                        <h4 class="font-bold text-slate-700">5. Portal Veedur√≠a</h4>
                        <p class="text-xs text-gray-500 mt-1">GitHub Pages<br>Visualizaci√≥n Est√°tica</p>
                    </div>
                </div>

                <!-- Dynamic Detail Panel -->
                <div id="arch-details" class="mt-8 bg-slate-50 rounded-lg p-6 border border-slate-200 transition-all duration-300">
                    <h3 class="font-bold text-lg text-slate-800 mb-2">Seleccione un nodo arriba para ver detalles t√©cnicos</h3>
                    <p class="text-gray-600 text-sm">Explore c√≥mo cada componente se integra en la soluci√≥n Open Source.</p>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <h3 class="text-lg font-semibold text-slate-800 mb-4">Flujo de Trabajo (Workflow)</h3>
                <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto">
<pre class="text-xs sm:text-sm text-green-400 font-mono">
name: Daily Data Harvest
on:
  schedule:
    - cron: '0 8 * * *' # Ejecutar a las 8 AM hora Colombia
jobs:
  veeduria-etl:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Rust
        uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable

      - name: Run Analytics Binary
        run: ./target/release/colombia-watchdog --mode=daily-ingest
        # Rust descarga JSON de SECOP, filtra contratos > $100M COP
        # y detecta sobrecostos comparando hist√≥ricos en memoria

      - name: Commit Reports
        run: |
          git config user.name "VeeduriaBot"
          git add ./data/reports/*.json
          git commit -m "Actualizaci√≥n diaria de contratos"
          git push
</pre>
                </div>
                <p class="text-xs text-gray-500 mt-2 text-right">Ejemplo simplificado de <code>.github/workflows/main.yml</code></p>
            </div>
        </section>

        <!-- VIEW: DATA SOURCES -->
        <section id="view-data" class="hidden space-y-8 animate-fade-in">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">Fuentes de Datos Nacionales</h2>
                <p class="text-gray-600">El sistema se sincroniza con los siguientes portales oficiales del Gobierno de Colombia usando APIs p√∫blicas (Socrata/CKAN).</p>
            </div>

            <!-- Filters -->
            <div class="flex gap-2 mb-6 flex-wrap">
                <button onclick="filterData('all')" class="px-3 py-1 bg-slate-800 text-white rounded-full text-sm hover:bg-slate-700">Todos</button>
                <button onclick="filterData('contratacion')" class="px-3 py-1 bg-white border border-gray-300 text-gray-600 rounded-full text-sm hover:bg-gray-50">Contrataci√≥n</button>
                <button onclick="filterData('finanzas')" class="px-3 py-1 bg-white border border-gray-300 text-gray-600 rounded-full text-sm hover:bg-gray-50">Finanzas</button>
                <button onclick="filterData('legal')" class="px-3 py-1 bg-white border border-gray-300 text-gray-600 rounded-full text-sm hover:bg-gray-50">Legal</button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="data-grid">
                <!-- Cards will be injected by JS -->
            </div>
        </section>

        <!-- VIEW: PROTOTYPE SIMULATOR -->
        <section id="view-simulator" class="hidden space-y-8 animate-fade-in">
             <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">Simulador de Veedur√≠a IA</h2>
                        <p class="text-gray-600 text-sm">Vea c√≥mo el sistema procesa un contrato real.</p>
                    </div>
                    <button onclick="runSimulation()" class="mt-4 md:mt-0 px-6 py-2 bg-e07a5f text-white font-bold rounded-lg shadow-md hover:bg-red-700 transition-colors flex items-center gap-2 bg-[#e07a5f]">
                        <span>‚ñ∂</span> Ejecutar Auditor√≠a
                    </button>
                </div>

                <!-- Simulation Stage -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Column 1: Input -->
                    <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
                        <h3 class="font-bold text-slate-700 mb-3 text-sm flex justify-between">
                            <span>1. Ingesta (API SECOP II)</span>
                            <span id="step-1-status" class="text-gray-400">‚óè</span>
                        </h3>
                        <div class="bg-white p-3 rounded border border-gray-200 font-mono text-xs text-gray-600 h-64 overflow-y-auto" id="sim-input">
                            <span class="text-gray-400 italic">Esperando ejecuci√≥n...</span>
                        </div>
                    </div>

                    <!-- Column 2: Rust Processing -->
                    <div class="border border-gray-200 rounded-lg p-4 bg-gray-50 relative">
                         <h3 class="font-bold text-slate-700 mb-3 text-sm flex justify-between">
                            <span>2. An√°lisis Rust (Filtros)</span>
                            <span id="step-2-status" class="text-gray-400">‚óè</span>
                        </h3>
                         <div class="bg-slate-900 p-3 rounded border border-gray-800 font-mono text-xs text-green-400 h-64 overflow-y-auto" id="sim-process">
                            <span class="text-gray-600 italic">System ready.</span>
                        </div>
                        <!-- Arrow overlay -->
                        <div class="hidden lg:block absolute top-1/2 -right-3 w-6 h-6 bg-gray-200 rotate-45 border-t border-r border-gray-300 z-10"></div>
                    </div>

                    <!-- Column 3: AI Output -->
                    <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
                         <h3 class="font-bold text-slate-700 mb-3 text-sm flex justify-between">
                            <span>3. Hallazgo IA (Reporte)</span>
                            <span id="step-3-status" class="text-gray-400">‚óè</span>
                        </h3>
                        <div class="bg-white p-3 rounded border border-gray-200 h-64 overflow-y-auto" id="sim-output">
                            <div class="flex flex-col items-center justify-center h-full text-gray-400">
                                <span class="text-4xl mb-2">ü§ñ</span>
                                <span class="text-xs">Resultados aparecer√°n aqu√≠</span>
                            </div>
                        </div>
                    </div>
                </div>
             </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-white py-12 border-t border-slate-800 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-lg font-bold mb-4 text-orange-400">Veedur√≠aAI.co</h3>
                    <p class="text-gray-400 text-sm">Proyecto de investigaci√≥n para la democratizaci√≥n del control fiscal mediante tecnolog√≠as libres.</p>
                </div>
                <div>
                    <h3 class="text-sm font-bold uppercase tracking-wider text-gray-500 mb-4">Tecnolog√≠as</h3>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li>Rust (Anal√≠tica)</li>
                        <li>GitHub Actions (ETL)</li>
                        <li>OpenAI/LLM (Inferencia)</li>
                        <li>Datos.gov.co (Fuente)</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-bold uppercase tracking-wider text-gray-500 mb-4">Fuentes Oficiales</h3>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition">Colombia Compra Eficiente</a></li>
                        <li><a href="#" class="hover:text-white transition">Agencia Nacional Digital</a></li>
                        <li><a href="#" class="hover:text-white transition">Secretar√≠a de Transparencia</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-slate-800 text-center text-xs text-gray-500">
                &copy; 2024 Investigaci√≥n Abierta. No afiliado al Gobierno Nacional.
            </div>
        </div>
    </footer>

    <script>
        // --- DATA & STATE MANAGEMENT ---
        const state = {
            currentTab: 'dashboard',
            simulationRunning: false,
            dataSources: [
                { id: 1, name: "SECOP II - Contratos Electr√≥nicos", category: "contratacion", status: "Activo", api: "Socrata Open Data API", url: "www.datos.gov.co", desc: "Base de datos principal de contrataci√≥n p√∫blica. Permite monitorear licitaciones en tiempo real." },
                { id: 2, name: "Tienda Virtual del Estado", category: "contratacion", status: "Activo", api: "JSON/CSV Dump", url: "colombiacompra.gov.co", desc: "Transacciones de m√≠nima cuant√≠a y acuerdos marco de precios." },
                { id: 3, name: "Sisfuturo - Entidades Territoriales", category: "finanzas", status: "Parcial", api: "Restringida", url: "chip.gov.co", desc: "Informaci√≥n financiera de municipios y departamentos. Requiere validaci√≥n de tokens." },
                { id: 4, name: "Cuentas Claras", category: "legal", status: "Activo", api: "API P√∫blica", url: "cne.gov.co", desc: "Reportes de ingresos y gastos de campa√±as pol√≠ticas." },
                { id: 5, name: "SECOP I - Hist√≥rico", category: "contratacion", status: "Legacy", api: "Socrata API", url: "www.datos.gov.co", desc: "Hist√≥rico de contrataci√≥n antes de 2015. Vital para entrenar modelos de IA." },
                { id: 6, name: "Sistema de Salud (ADRES)", category: "finanzas", status: "Complejo", api: "Consulta Web", url: "adres.gov.co", desc: "Giros directos al r√©gimen subsidiado y contributivo. Dif√≠cil de automatizar (Scraping necesario)." }
            ]
        };

        // --- NAVIGATION LOGIC ---
        function switchTab(tabId) {
            // Update State
            state.currentTab = tabId;

            // UI Updates
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${tabId}`)?.classList.add('active');

            // Hide all sections
            ['dashboard', 'architecture', 'data', 'simulator'].forEach(id => {
                document.getElementById(`view-${id}`).classList.add('hidden');
            });

            // Show selected section
            const activeSection = document.getElementById(`view-${tabId}`);
            activeSection.classList.remove('hidden');

            // Trigger animations or chart redraws if necessary
            if (tabId === 'dashboard') {
                renderCharts();
            } else if (tabId === 'data') {
                renderDataGrid(state.dataSources);
            }
        }

        // --- CHART GENERATION (Chart.js) ---
        let efficiencyChartInstance = null;
        let coverageChartInstance = null;

        function renderCharts() {
            // Efficiency Chart (Bar)
            const ctx1 = document.getElementById('efficiencyChart');
            if (ctx1 && !efficiencyChartInstance) {
                efficiencyChartInstance = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['Python (Pandas)', 'Node.js', 'Rust (Polars/Serde)', 'Go'],
                        datasets: [{
                            label: 'Tiempo de Procesamiento (1GB JSON)',
                            data: [120, 45, 8, 15], // Seconds
                            backgroundColor: [
                                '#e2e8f0',
                                '#e2e8f0',
                                '#e07a5f', // Highlight Rust
                                '#e2e8f0'
                            ],
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.raw} segundos`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Segundos (Menos es mejor)' }
                            }
                        }
                    }
                });
            }

            // Coverage Chart (Radar)
            const ctx2 = document.getElementById('coverageChart');
            if (ctx2 && !coverageChartInstance) {
                coverageChartInstance = new Chart(ctx2, {
                    type: 'radar',
                    data: {
                        labels: ['Calidad Datos', 'Frecuencia', 'API Docs', 'Volumen', 'Estructura'],
                        datasets: [{
                            label: 'SECOP II',
                            data: [90, 95, 80, 100, 85],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        },
                        {
                            label: 'Salud / ADRES',
                            data: [60, 40, 30, 80, 40],
                            borderColor: '#94a3b8',
                            backgroundColor: 'rgba(148, 163, 184, 0.2)',
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                angleLines: { color: '#e2e8f0' },
                                grid: { color: '#e2e8f0' },
                                pointLabels: { font: { size: 12 } },
                                suggestMin: 0,
                                suggestMax: 100
                            }
                        }
                    }
                });
            }
        }

        // --- DATA GRID LOGIC ---
        function renderDataGrid(data) {
            const grid = document.getElementById('data-grid');
            grid.innerHTML = ''; // Clear

            data.forEach(source => {
                const card = document.createElement('div');
                card.className = 'bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-blue-300 transition-colors flex flex-col';

                let badgeColor = source.status === 'Activo' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800';

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <span class="px-2 py-1 rounded text-xs font-bold uppercase ${badgeColor}">${source.status}</span>
                        <span class="text-xs text-gray-400 capitalize">${source.category}</span>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 mb-2">${source.name}</h3>
                    <p class="text-sm text-gray-600 mb-4 flex-grow">${source.desc}</p>
                    <div class="pt-4 border-t border-gray-100 text-xs text-gray-500 font-mono">
                        <div class="flex items-center gap-1 mb-1">
                            <span>üîå</span> ${source.api}
                        </div>
                        <div class="flex items-center gap-1">
                            <span>üåê</span> ${source.url}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function filterData(category) {
            if (category === 'all') {
                renderDataGrid(state.dataSources);
            } else {
                const filtered = state.dataSources.filter(item => item.category === category);
                renderDataGrid(filtered);
            }
        }

        // --- ARCHITECTURE INTERACTION ---
        const archDetails = {
            source: {
                title: "Fuentes P√∫blicas (Datos Abiertos)",
                content: "El gobierno colombiano expone datos a trav√©s de Socrata (www.datos.gov.co). La API permite consultas SQL-like (SoQL). El principal desaf√≠o es el 'Rate Limiting' y la inconsistencia en los esquemas de datos antiguos."
            },
            etl: {
                title: "GitHub Actions & Rust",
                content: "El n√∫cleo del sistema. Usamos binarios de Rust compilados por ser peque√±os (<10MB) y ultra r√°pidos. Un workflow programado (CRON) despierta una m√°quina virtual, descarga el binario, y ejecuta la extracci√≥n. Rust maneja la concurrencia para descargar m√∫ltiples endpoints sin bloquear la memoria, filtrando JSONs gigantes en streaming (sin cargar todo en RAM)."
            },
            storage: {
                title: "Git Data Lake",
                content: "En lugar de SQL, usamos 'Flat Data'. Los datos procesados se guardan como archivos JSON o CSV directamente en el repositorio. Esto da versionamiento gratis (historial de cambios en contratos) y permite que cualquiera audite la base de datos simplemente clonando el repo."
            },
            ai: {
                title: "An√°lisis IA e Inferencia",
                content: "Una vez los datos est√°n limpios en el repo, un segundo script env√≠a 'chunks' de texto relevante a un LLM (v√≠a API) con un prompt espec√≠fico: 'Analiza este objeto de contrato y busca se√±ales de fraccionamiento o sobrecostos'. El resultado se guarda como metadato."
            },
            frontend: {
                title: "Portal Ciudadano",
                content: "Una SPA est√°tica (como esta) alojada en GitHub Pages. Al cargar, lee los JSONs generados por el backend. Costo de hosting: $0. Seguridad m√°xima al no tener base de datos expuesta."
            }
        };

        function showNodeDetails(nodeKey) {
            const panel = document.getElementById('arch-details');
            const info = archDetails[nodeKey];

            // Visual feedback on nodes
            document.querySelectorAll('.node-card').forEach(el => el.classList.remove('node-active'));
            // Find the clicked element logic implies adding ID or checking logic, simplified here by identifying clicked context if passing 'this' but using generic clear for now.
            // In a real app we'd highlight specific node.

            panel.innerHTML = `
                <div class="animate-fade-in">
                    <h3 class="font-bold text-lg text-[#e07a5f] mb-2">${info.title}</h3>
                    <p class="text-slate-700 leading-relaxed">${info.content}</p>
                </div>
            `;
        }

        // --- SIMULATOR LOGIC ---
        async function runSimulation() {
            if(state.simulationRunning) return;
            state.simulationRunning = true;

            const btn = document.querySelector('button[onclick="runSimulation()"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<span>‚è≥</span> Procesando...`;
            btn.classList.add('opacity-75', 'cursor-not-allowed');

            // Reset UI
            document.getElementById('sim-input').innerHTML = '';
            document.getElementById('sim-process').innerHTML = '';
            document.getElementById('sim-output').innerHTML = '';
            ['step-1-status', 'step-2-status', 'step-3-status'].forEach(id => document.getElementById(id).className = 'text-gray-400');

            // DATA SAMPLE
            const sampleContract = {
                id: "CO1.PCCNTR.4519283",
                entity: "ALCALD√çA DE MUNICIPIO X",
                object: "SUMINISTRO DE ALIMENTOS PAE",
                value: 1500000000,
                contractor: "UNI√ìN TEMPORAL ALIMENTOS 2024",
                date: "2024-02-15"
            };

            // STEP 1: Ingest
            document.getElementById('step-1-status').className = 'text-green-500 font-bold';
            await typeWriter('sim-input', JSON.stringify(sampleContract, null, 2), 10);

            // STEP 2: Rust Process
            document.getElementById('step-2-status').className = 'text-orange-500 font-bold animate-pulse-fast';
            const logs = [
                "> ./veeduria_cli --analyze CO1.PCCNTR.4519283",
                "[INFO] Fetching historical data for 'ALCALD√çA DE MUNICIPIO X'...",
                "[RUST] Memory usage: 4.2MB. Threads: 8",
                "[WARN] Price deviation detected in item 'Lenteja x 500g'",
                "[WARN] Contractor 'UNI√ìN TEMPORAL...' created 5 days before contract.",
                "[SUCCESS] Analysis complete in 0.04s. Flag: RED"
            ];

            const processContainer = document.getElementById('sim-process');
            for (let log of logs) {
                processContainer.innerHTML += `<div class="mb-1 border-b border-gray-800 pb-1">${log}</div>`;
                processContainer.scrollTop = processContainer.scrollHeight;
                await new Promise(r => setTimeout(r, 600));
            }
            document.getElementById('step-2-status').className = 'text-green-500 font-bold';

            // STEP 3: AI Output
            document.getElementById('step-3-status').className = 'text-purple-500 font-bold';
            const aiReport = `
                <div class="bg-red-50 border-l-4 border-red-500 p-3 mb-2">
                    <h4 class="font-bold text-red-700 text-sm">üö© ALERTA DE RIESGO ALTO</h4>
                    <p class="text-xs text-red-600 mt-1">Probabilidad de corrupci√≥n: 85%</p>
                </div>
                <div class="space-y-2 text-sm text-gray-700">
                    <p><strong>Hallazgos IA:</strong></p>
                    <ul class="list-disc ml-4 space-y-1 text-xs">
                        <li>El contratista no tiene experiencia previa en PAE.</li>
                        <li>Sobrecosto del 40% comparado con precios del DANE para la regi√≥n.</li>
                        <li>Contrataci√≥n directa sin pluralidad de oferentes.</li>
                    </ul>
                    <div class="mt-3 p-2 bg-blue-50 text-blue-800 text-xs rounded">
                        <strong>Recomendaci√≥n:</strong> Escalar a la Procuradur√≠a autom√°ticamente.
                    </div>
                </div>
            `;
            document.getElementById('sim-output').innerHTML = aiReport;
            document.getElementById('step-3-status').className = 'text-green-500 font-bold';

            // Reset Button
            state.simulationRunning = false;
            btn.innerHTML = originalText;
            btn.classList.remove('opacity-75', 'cursor-not-allowed');
        }

        // Helper for typing effect
        function typeWriter(elementId, text, speed) {
            return new Promise(resolve => {
                let i = 0;
                const container = document.getElementById(elementId);
                container.innerHTML = "";
                function type() {
                    if (i < text.length) {
                        container.innerHTML += text.charAt(i);
                        i++;
                        setTimeout(type, speed);
                    } else {
                        resolve();
                    }
                }
                type();
            });
        }

        // --- INIT ---
        window.addEventListener('DOMContentLoaded', () => {
            renderCharts();
            // Load dashboard by default
            switchTab('dashboard');
        });

    </script>
</body>
</html>