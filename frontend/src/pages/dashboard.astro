---
import Layout from '../layouts/Layout.astro';
import RedFlagList from '../components/RedFlagList.svelte';
import DashboardStats from '../components/DashboardStats.svelte';
---

<Layout title="Dashboard | Veeduría Ciudadana">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
		<header class="mb-10 flex flex-col md:flex-row md:items-center justify-between gap-4">
			<div>
				<h1 class="text-3xl font-bold text-white">Dashboard de Riesgo</h1>
				<p class="text-gray-400">Monitoreo en tiempo real de la contratación pública.</p>
			</div>
			<div class="flex gap-2">
				<button class="glass-button !bg-brand-500/20 active">Diario</button>
				<button class="px-6 py-2 rounded-full border border-white/10 text-gray-400 hover:bg-white/5 transition-colors">Semanal</button>
				<button class="px-6 py-2 rounded-full border border-white/10 text-gray-400 hover:bg-white/5 transition-colors">Mensual</button>
			</div>
		</header>

		<!-- Main Grid -->
		<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
			<!-- Main Map Area (Mock) -->
			<div class="lg:col-span-2 glass-panel rounded-2xl p-6 h-[500px] flex flex-col relative overflow-hidden group">
				<div class="absolute inset-0 bg-[url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e8/Colombia_relief_location_map.jpg/612px-Colombia_relief_location_map.jpg')] bg-cover bg-center opacity-20 mix-blend-overlay grayscale group-hover:scale-105 transition-transform duration-700"></div>
				<div class="absolute inset-0 bg-gradient-to-t from-obsidian-950 via-transparent to-transparent"></div>

				<h3 class="relative z-10 text-xl font-semibold mb-4 text-white">Mapa de Calor: Riesgo de Corrupción</h3>

				<!-- Mock Hotspots -->
				<div class="absolute top-1/3 left-1/3 w-24 h-24 bg-red-500/30 rounded-full blur-xl animate-pulse"></div>
				<div class="absolute top-1/2 left-1/2 w-32 h-32 bg-orange-500/20 rounded-full blur-xl animate-pulse delay-700"></div>
				<div class="absolute bottom-1/3 right-1/4 w-16 h-16 bg-red-500/40 rounded-full blur-xl animate-pulse delay-300"></div>

				<DashboardStats client:load />
			</div>

			<!-- Dynamic Red Flags List - Loads from daily_report.json -->
			<RedFlagList client:load />
		</div>

		<!-- Charts Section -->
		<div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-8">
			<div class="glass-panel p-6 rounded-2xl">
				<h3 class="text-lg font-semibold text-white mb-4">Tendencia de Irregularidades</h3>
				<div class="h-64 flex items-end gap-2 justify-between px-4 pb-4 border-b border-white/5 relative">
					<!-- Mock Bars -->
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[30%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">12</div></div>
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[45%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">18</div></div>
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[25%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">10</div></div>
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[60%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">24</div></div>
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[40%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">16</div></div>
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[75%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">30</div></div>
					<div class="w-full bg-brand-500/20 rounded-t hover:bg-brand-500/40 transition-all h-[55%] relative group"><div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black/80 px-2 py-1 rounded text-xs hidden group-hover:block">22</div></div>
				</div>
				<div class="flex justify-between text-xs text-gray-500 mt-2">
					<span>Lun</span><span>Mar</span><span>Mie</span><span>Jue</span><span>Vie</span><span>Sab</span><span>Dom</span>
				</div>
			</div>

			<div class="glass-panel p-6 rounded-2xl">
				<h3 class="text-lg font-semibold text-white mb-4">Tipos de Alerta</h3>
				<div class="space-y-4">
					<div class="space-y-1">
						<div class="flex justify-between text-sm">
							<span class="text-gray-300">Licitante Único</span>
							<span class="text-white font-bold">45%</span>
						</div>
						<div class="w-full bg-white/5 rounded-full h-2">
							<div class="bg-red-500 h-2 rounded-full" style="width: 45%"></div>
						</div>
					</div>
					<div class="space-y-1">
						<div class="flex justify-between text-sm">
							<span class="text-gray-300">Sobrecostos (Benford)</span>
							<span class="text-white font-bold">30%</span>
						</div>
						<div class="w-full bg-white/5 rounded-full h-2">
							<div class="bg-orange-500 h-2 rounded-full" style="width: 30%"></div>
						</div>
					</div>
					<div class="space-y-1">
						<div class="flex justify-between text-sm">
							<span class="text-gray-300">Pliegos Sastre (NLP)</span>
							<span class="text-white font-bold">25%</span>
						</div>
						<div class="w-full bg-white/5 rounded-full h-2">
							<div class="bg-brand-500 h-2 rounded-full" style="width: 25%"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</Layout>
